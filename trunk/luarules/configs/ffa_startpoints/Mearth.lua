-- this is a template ffa_startpoints.lua file that returna a randomized startpoint table, read code & example1 for more info

-- to add a ffa startpoint config inside game:
-- (1) fill in this template file as appropriate and rename it to <mapname>.lua, put this file in /luarules/configs/ffa_startpoints
-- (2) add the filename/mapname to the table of known maps in the ffa_startpoints.lua file in the same dir

local startpoints = { --locations of the startpoints
	[1] = {
		x = 4624.1889648438,
		z = 3843.5366210938,
	},
	[2] = {
		x = 5791.7661132813,
		z = 5408.5146484375,
	},
	[3] = {
		x = 5410.6635742188,
		z = 9297.1435546875,
	},
	[4] = {
		x = 2939.1779785156,
		z = 6443.8134765625,
	},
	[5] = {
		x = 7274.4868164063,
		z = 2771.6064453125,
	},
	[6] = {
		x = 4434.052734375,
		z = 11337.841796875,
	},
	[7] = {
		x = 3856.2658691406,
		z = 2095.9821777344,
	},
	[8] = {
		x = 8000.7211914063,
		z = 5410.57421875,
	},
	[9] = {
		x = 8910.3671875,
		z = 8308.2724609375,
	},
	[10] = {
		x = 5893.306640625,
		z = 14171.290039063,
	},
	[11] = {
		x = 2474.2956542969,
		z = 4258.9633789063,
	},
	[12] = {
		x = 6561.2036132813,
		z = 944.35345458984,
	},
	[13] = {
		x = 9466.693359375,
		z = 11643.290039063,
	},
	[14] = {
		x = 1955.1845703125,
		z = 9237.6923828125,
	},
	[15] = {
		x = 3696.7927246094,
		z = 13688.720703125,
	},
	[16] = {
		x = 9247.1083984375,
		z = 990.34344482422,
	},
	[17] = {
		x = 9443.2349878234,
		z = 14723.237862474,
	},
}


local ffaStartPointsAll = { --ffaStartPointsAll[#allyteams][id] = {table of keys of startpoints table}
	[1] = {
		{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13},{14},{15},{16},
	},	
	[2] = {
        {1,3},
        {1,13},
        {5,3},
        {5,13},
        {12,17},
        {16,17},
        {14,15},
        {15,16},
        {7,17},
        {3,9},
        {2,8},
        {4,9},
        {6,8},
        {2,3},
        {4,10},
        {8,9},       
	},
	[3] = {
        {3,7,8},
        {3,12,17},
        {10,14,16},
        {3,4,8},
        {4,13,16},
        {2,3,9},
	},
	[4] = {
        {1,8,3,13},
        {16,4,9,6},
        {6,13,4,8},
        {13,14,15,16},
        {7,12,3,6},
        {4,9,10,16},
	},
	[5] = {
        {3,8,11,13,16},
        {4,6,9,12,17},
        {4,6,8,13,16},
        {14,10,16,2,13},
        {17,6,9,4,16},
    },
	[6] = {
        {11,12,8,3,13,17},
        {14,15,16,2,9,17},
        {12,16,14,15,9,13},
        {3,11,12,8,13,15},
        {4,11,8,9,10,15},
        {14,15,17,16,1,9},
	},
	[7] = {
        {7,16,4,8,6,13,10},
        {11,12,2,3,13,14,15},
        {4,11,3,6,5,8,9},
        {2,3,4,5,6,7,8},
        {14,15,17,6,4,7,16},
	},
	[8] = {
        {3,6,13,17,2,5,11,12},
        {7,16,4,8,6,9,10,17},
        {14,15,17,4,7,16,2,9},
        {12,16,13,17,3,4,6,11},
        {1,3,4,5,6,7,8,9},
        {4,7,16,3,8,13,14,15},
	},
	[9] = {
        {4,7,16,3,8,14,15,13,17},
        {5,16,4,11,2,9,13,17,15},
        {10,13,6,9,2,4,7,14,16},
        {1,5,8,9,3,14,15,17,16}
	},
	[10] = {
		{3,4,6,7,9,11,12,13,16,17},
		{1,4,5,6,7,9,10,12,13,16},
		{1,2,6,9,11,12,13,14,15,16},
		{2,3,4,5,7,9,10,12,16,17},
	},
	[11] = {
		{2,4,6,7,8,10,11,12,13,16,17},
		{3,4,5,6,7,10,11,12,13,16,17},
		{1,2,3,4,6,7,9,10,11,13,17},
		{1,4,6,7,8,9,12,13,14,15,16},
	},
	[12] = {
		{3,4,6,7,8,9,11,12,13,14,15,16},
		{1,4,6,7,8,9,10,12,14,15,16,17},
		{1,4,5,6,7,8,9,10,11,12,13,16},
		{2,3,4,5,6,7,9,10,11,12,13,16},
	},
	[13] = {
		{2,3,5,6,7,8,11,12,13,14,15,16,17},
		{1,3,4,5,6,7,8,9,10,11,12,13,16},
		{1,4,6,7,8,9,11,12,13,14,15,16,17},
		{1,2,3,5,6,7,9,10,12,14,15,16,17},
	},
	[14] = {
		{1,3,4,5,6,7,8,9,10,11,12,13,16,17},
		{3,4,5,6,7,8,9,10,11,12,13,14,15,16},
		{2,3,4,5,6,7,9,11,12,13,14,15,16,17},
		{1,2,3,4,5,7,9,10,12,13,14,15,16,17},
	},
	[15] = {
		{3,4,5,6,7,8,9,10,11,12,13,14,15,16,17},
		{1,3,4,5,6,7,8,9,11,12,13,14,15,16,17},
		{2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
		{1,2,3,5,6,7,8,9,10,11,12,13,14,15,16},
	},
	[16] = {
		{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
		{2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17},
		{1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,17},
		{1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17},
		{1,2,3,5,6,7,8,9,10,11,12,13,14,15,16,17},
	},
}

-- check that each of the above entries has the right length table
--[[
for i=1,16 do
	for j,v in pairs(ffaStartPointsAll[i]) do
		if #v ~= i then
			Spring.Echo("Error:", i,j)
		end
	end
end
]]


-- now construct (in global namespace) the ffa startpoints by randomly picking one element from each of the subtables of ffaStartPointsAll
-- and mapping that to a set of startpoints using the startpoints table
ffaStartPoints  = {}

for i=1,16 do
	local n = math.random(#(ffaStartPointsAll[i]))
	ffaStartPoints[i] = {}
	for j = 1,i do
		--Spring.Echo(i,n,j)
		local id = ffaStartPointsAll[i][n][j] 
		local sx = startpoints[id].x
		local sz = startpoints[id].z
		--Spring.Echo(sx,sz)
		ffaStartPoints[i][j] = {x=sx,z=sz} 
	end
end